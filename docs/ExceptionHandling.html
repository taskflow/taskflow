<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cookbook &raquo; Exception Handling | Taskflow QuickStart</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,400i,600,600i%7CSource+Code+Pro:400,400i,600" />
  <link rel="stylesheet" href="m-dark+documentation.compiled.css" />
  <link rel="icon" href="favicon.ico" type="image/vnd.microsoft.icon" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#22272e" />
</head>
<body>
<header><nav id="navigation">
  <div class="m-container">
    <div class="m-row">
      <span id="m-navbar-brand" class="m-col-t-8 m-col-m-none m-left-m">
        <a href="https://taskflow.github.io"><img src="taskflow_logo.png" alt="" />Taskflow</a> <span class="m-breadcrumb">|</span> <a href="index.html" class="m-thin">QuickStart</a>
      </span>
      <div class="m-col-t-4 m-hide-m m-text-right m-nopadr">
        <a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
          <path id="m-doc-search-icon-path" d="m6 0c-3.31 0-6 2.69-6 6 0 3.31 2.69 6 6 6 1.49 0 2.85-0.541 3.89-1.44-0.0164 0.338 0.147 0.759 0.5 1.15l3.22 3.79c0.552 0.614 1.45 0.665 2 0.115 0.55-0.55 0.499-1.45-0.115-2l-3.79-3.22c-0.392-0.353-0.812-0.515-1.15-0.5 0.895-1.05 1.44-2.41 1.44-3.89 0-3.31-2.69-6-6-6zm0 1.56a4.44 4.44 0 0 1 4.44 4.44 4.44 4.44 0 0 1-4.44 4.44 4.44 4.44 0 0 1-4.44-4.44 4.44 4.44 0 0 1 4.44-4.44z"/>
        </svg></a>
        <a id="m-navbar-show" href="#navigation" title="Show navigation"></a>
        <a id="m-navbar-hide" href="#" title="Hide navigation"></a>
      </div>
      <div id="m-navbar-collapse" class="m-col-t-12 m-show-m m-col-m-none m-right-m">
        <div class="m-row">
          <ol class="m-col-t-6 m-col-m-none">
            <li><a href="pages.html">Handbook</a></li>
            <li><a href="namespaces.html">Namespaces</a></li>
          </ol>
          <ol class="m-col-t-6 m-col-m-none" start="3">
            <li><a href="annotated.html">Classes</a></li>
            <li><a href="files.html">Files</a></li>
            <li class="m-show-m"><a href="#search" class="m-doc-search-icon" title="Search" onclick="return showSearch()"><svg style="height: 0.9rem;" viewBox="0 0 16 16">
              <use href="#m-doc-search-icon-path" />
            </svg></a></li>
          </ol>
        </div>
      </div>
    </div>
  </div>
</nav></header>
<main><article>
  <div class="m-container m-container-inflatable">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <h1>
          <span class="m-breadcrumb"><a href="Cookbook.html">Cookbook</a> &raquo;</span>
          Exception Handling
        </h1>
        <nav class="m-block m-default">
          <h3>Contents</h3>
          <ul>
            <li>
              <a href="#UnderstandTheLogicOfExceptionHandlingInTaskflow">Understand the Logic of Exception Handling in Taskflow</a>
              <ul>
                <li><a href="#Secnario1SynchronousExceptionPropagation">Scenario 1: Synchronous Exception Propagation</a></li>
                <li><a href="#Scenario2AsynchronousExceptionPropagation">Scenario 2: Asynchronous Exception Propagation</a></li>
                <li><a href="#Scenario3ContextualExceptionPropagation">Scenario 3: Contextual Exception Propagation</a></li>
                <li><a href="#ExceptionHandlingAlgorithmFlow">Algorithm Flow of Exception Handling</a></li>
              </ul>
            </li>
            <li><a href="#CatchAnExceptionFromARunningTaskflow">Example: Catch an Exception from a Running Taskflow</a></li>
            <li><a href="#CatchAnExceptionFromASubflow">Example: Catch an Exception from a Subflow</a></li>
            <li><a href="#CatchAnExceptionFromAnAsyncTask">Example: Catch an Exception from an Async Task</a></li>
            <li><a href="#CatchAnExceptionFromACorunLoop">Example: Catch an Exception from a Corun Loop</a></li>
            <li><a href="#RetrieveTheExceptionPointerOfATask">Retrieve the Exception Pointer of a Task</a></li>
            <li><a href="#TurnOffExceptionHandling">Turn off Exception Handling</a></li>
          </ul>
        </nav>
<p>This chapter discusses how to handle exceptions in Taskflow, so you can correctly catch or propagate exceptions within your workloads.</p><section id="UnderstandTheLogicOfExceptionHandlingInTaskflow"><h2><a href="#UnderstandTheLogicOfExceptionHandlingInTaskflow">Understand the Logic of Exception Handling in Taskflow</a></h2><p>Exception handling is a powerful feature in Taskflow that distinguishes it from other task-parallel libraries that ignore this aspect. Taskflow follows a simple yet robust design to handle exceptions in a multi-threaded environment, ensuring program correctness without sacrificing parallel efficiency. The logic can be understood through three different scenarios, depending on how a task is executed and how the runtime reports errors.</p><div class="m-graph"><svg style="width: 58.900rem; height: 18.800rem;" viewBox="0.00 0.00 589.00 188.00">
<g transform="scale(1 1) rotate(0) translate(4 184)">
<title>TaskflowExceptionHandling</title>
<g class="m-node m-flat">
<title>ExceptionHandling</title>
<polygon points="391.5,-180 223.5,-180 223.5,-144 391.5,-144 391.5,-180"/>
<text text-anchor="middle" x="307.5" y="-159.5" font-family="Helvetica,sans-Serif" font-size="10.00">Exception Handling in Taskflow</text>
</g>
<g class="m-node m-flat">
<title>Scenarios</title>
<polygon points="307.5,-108 183.42,-90 307.5,-72 431.58,-90 307.5,-108"/>
<text text-anchor="middle" x="307.5" y="-87.5" font-family="Helvetica,sans-Serif" font-size="10.00">A task throws an exception</text>
</g>
<g class="m-edge">
<title>ExceptionHandling&#45;&gt;Scenarios</title>
<path d="M307.5,-143.7C307.5,-135.98 307.5,-126.71 307.5,-118.11"/>
<polygon points="311,-118.1 307.5,-108.1 304,-118.1 311,-118.1"/>
</g>
<g class="m-node m-flat">
<title>Immediate</title>
<polygon points="191,-36 0,-36 0,0 191,0 191,-36"/>
<text text-anchor="middle" x="95.5" y="-21" font-family="Helvetica,sans-Serif" font-size="10.00">Scenario 1:</text>
<text text-anchor="middle" x="95.5" y="-10" font-family="Helvetica,sans-Serif" font-size="10.00">Synchronous Exception Propagation</text>
</g>
<g class="m-edge">
<title>Scenarios&#45;&gt;Immediate</title>
<path d="M271.54,-77.13C240.2,-66.78 194.07,-51.55 156.9,-39.27"/>
<polygon points="157.76,-35.87 147.16,-36.06 155.56,-42.52 157.76,-35.87"/>
</g>
<g class="m-node m-flat">
<title>Propagation</title>
<polygon points="406,-36 209,-36 209,0 406,0 406,-36"/>
<text text-anchor="middle" x="307.5" y="-21" font-family="Helvetica,sans-Serif" font-size="10.00">Scenario 2:</text>
<text text-anchor="middle" x="307.5" y="-10" font-family="Helvetica,sans-Serif" font-size="10.00">Asynchronous Exception Propagation</text>
</g>
<g class="m-edge">
<title>Scenarios&#45;&gt;Propagation</title>
<path d="M307.5,-71.7C307.5,-63.98 307.5,-54.71 307.5,-46.11"/>
<polygon points="311,-46.1 307.5,-36.1 304,-46.1 311,-46.1"/>
</g>
<g class="m-node m-flat">
<title>Silent</title>
<polygon points="581,-36 424,-36 424,0 581,0 581,-36"/>
<text text-anchor="middle" x="502.5" y="-21" font-family="Helvetica,sans-Serif" font-size="10.00">Scenario 3:</text>
<text text-anchor="middle" x="502.5" y="-10" font-family="Helvetica,sans-Serif" font-size="10.00">Silent Exception Propagation</text>
</g>
<g class="m-edge">
<title>Scenarios&#45;&gt;Silent</title>
<path d="M341.47,-76.81C370.07,-66.54 411.59,-51.63 445.31,-39.53"/>
<polygon points="446.82,-42.71 455.05,-36.03 444.45,-36.12 446.82,-42.71"/>
</g>
</g>
</svg>
</div><p>When multiple scenarios are applicable, Taskflow resolves exceptions by prioritizing scenario 1, then scenario 2, and finally scenario 3. We start with a brief overview of the three scenarios and then examine different use cases in more detail.</p><section id="Secnario1SynchronousExceptionPropagation"><h3><a href="#Secnario1SynchronousExceptionPropagation">Scenario 1: Synchronous Exception Propagation</a></h3><p>If the taskflow is executed in a blocking context where the application thread waits for completion, such as <a href="classtf_1_1Executor.html#a8fcd9e0557922bb8194999f0cd433ea8" class="m-doc">tf::<wbr />Executor::<wbr />corun</a>, exceptions are immediately propagated to the caller. In this scenario, the executor does not defer or aggregate errors; instead, it synchronously rethrows the exception to the application thread as soon as it is detected.</p><pre class="m-code"><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">executor</span><span class="p">.</span><span class="n">corun</span><span class="p">(</span><span class="n">taskflow</span><span class="p">);</span><span class="w"> </span>
<span class="p">}</span>
<span class="k">catch</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">();</span>
<span class="p">}</span></pre></section><section id="Scenario2AsynchronousExceptionPropagation"><h3><a href="#Scenario2AsynchronousExceptionPropagation">Scenario 2: Asynchronous Exception Propagation</a></h3><p>When you launch tasks using functions like <a href="classtf_1_1Executor.html#a8d08f0cb79e7b3780087975d13368a96" class="m-doc">tf::<wbr />Executor::<wbr />run</a> or <a href="classtf_1_1Executor.html#af960048056f7c6b5bc71f4f526f05df7" class="m-doc">tf::<wbr />Executor::<wbr />async</a>, any exception thrown within the task is captured and stored in a shared state associated with the returned <a href="classtf_1_1Future.html" class="m-doc">tf::<wbr />Future</a> or <a href="http://en.cppreference.com/w/cpp/thread/future.html" class="m-doc-external">std::<wbr />future</a>. This exception can later be rethrown when you access the result of the shared state.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Future</span><span class="o">&lt;</span><span class="kt">void</span><span class="o">&gt;</span><span class="w"> </span><span class="n">fu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">);</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">fu</span><span class="p">.</span><span class="n">get</span><span class="p">();</span><span class="w"> </span>
<span class="p">}</span>
<span class="k">catch</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">exception</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">();</span>
<span class="p">}</span></pre></section><section id="Scenario3ContextualExceptionPropagation"><h3><a href="#Scenario3ContextualExceptionPropagation">Scenario 3: Contextual Exception Propagation</a></h3><p>Unlike scenarios 1 and 2, where exceptions are immediately reported to a waiting thread or an observable shared state, this scenario is reached only when no such reporting context exists. In such cases, the exception is not reported to the caller by default. Instead, the runtime first attempts to propagate the exception to the nearest parent execution context, if one exists. If no such parent context exists, the exception is silently suppressed.</p><pre class="m-code"><span class="c1">// A silent-async task with no parent context: </span>
<span class="c1">// the exception is silently suppressed.</span>
<span class="n">executor</span><span class="p">.</span><span class="n">silent_async</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span>
<span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;exception is silently caught by this task&quot;</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// A silent-async task with a parent context:</span>
<span class="c1">// the exception is propagated to the parent task group.</span>
<span class="n">executor</span><span class="p">.</span><span class="n">silent_async</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span>
<span class="w">  </span><span class="n">tf</span><span class="o">::</span><span class="n">TaskGroup</span><span class="w"> </span><span class="n">tg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">executor</span><span class="p">.</span><span class="n">task_group</span><span class="p">();</span>
<span class="w">  </span><span class="n">tg</span><span class="p">.</span><span class="n">silent_async</span><span class="p">([](){</span><span class="w"> </span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;exception is propagated to the parent task group&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">tg</span><span class="p">.</span><span class="n">corun</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">catch</span><span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">();</span><span class="w"> </span>
<span class="w">  </span><span class="p">}</span>
<span class="p">});</span></pre></section><section id="ExceptionHandlingAlgorithmFlow"><h3><a href="#ExceptionHandlingAlgorithmFlow">Algorithm Flow of Exception Handling</a></h3><p>The figure below illustrates how Taskflow processes exceptions and prioritizes their handling according to the availability of an execution context. When a task throws an exception, the runtime first walks up the task hierarchy to mark the execution path as exceptional and identify two types of anchor nodes, <em>explicit anchor</em> and <em>implicit anchor</em> (i.e., candidate nodes that will catch the exception). If an explicit anchor is found, indicating a blocking execution context like corun or join, the exception is immediately captured and later rethrown on the waiting application thread (Scenario 1). If no explicit anchor exists, the runtime next checks for an associated shared state, allowing the exception to be reported asynchronously later when the shared state is accessed (Scenario 2). Failing that, the exception is propagated to the nearest implicit anchor, such as a parent task group, if one exists (Scenario 3).Only when none of these reporting contexts are available does the runtime suppress the exception by storing it locally in the throwing task. This algorithm ensures exceptions are reported whenever possible while preserving safe and efficient parallel execution.</p><div class="m-graph"><svg style="width: 57.000rem; height: 45.400rem;" viewBox="0.00 0.00 570.00 454.00">
<g transform="scale(1 1) rotate(0) translate(4 450)">
<title>ProcessException</title>
<g class="m-node m-flat">
<title>start</title>
<polygon points="188,-446 48,-446 48,-410 188,-410 188,-446"/>
<text text-anchor="middle" x="118" y="-425.5" font-family="Helvetica,sans-Serif" font-size="10.00">Exception thrown by task</text>
</g>
<g class="m-node m-flat">
<title>mark</title>
<polygon points="236,-373 0,-373 0,-337 236,-337 236,-373"/>
<text text-anchor="middle" x="118" y="-358" font-family="Helvetica,sans-Serif" font-size="10.00">Traverse to the root to find exception catcher</text>
<text text-anchor="middle" x="118" y="-347" font-family="Helvetica,sans-Serif" font-size="10.00">(explicit &amp; implicit anchors)</text>
</g>
<g class="m-edge">
<title>start&#45;&gt;mark</title>
<path d="M118,-409.81C118,-401.79 118,-392.05 118,-383.07"/>
<polygon points="121.5,-383.03 118,-373.03 114.5,-383.03 121.5,-383.03"/>
</g>
<g class="m-node m-flat">
<title>explicit</title>
<polygon points="180.5,-300 55.5,-300 55.5,-264 180.5,-264 180.5,-300"/>
<text text-anchor="middle" x="118" y="-285" font-family="Helvetica,sans-Serif" font-size="10.00">Explicit anchor found?</text>
<text text-anchor="middle" x="118" y="-274" font-family="Helvetica,sans-Serif" font-size="10.00">(blocking context)</text>
</g>
<g class="m-edge">
<title>mark&#45;&gt;explicit</title>
<path d="M118,-336.81C118,-328.79 118,-319.05 118,-310.07"/>
<polygon points="121.5,-310.03 118,-300.03 114.5,-310.03 121.5,-310.03"/>
</g>
<g class="m-node m-flat">
<title>explicit_catch</title>
<polygon points="188,-217 8,-217 8,-176 188,-176 188,-217"/>
<text text-anchor="middle" x="98" y="-205" font-family="Helvetica,sans-Serif" font-size="10.00">Store exception in explicit anchor</text>
<text text-anchor="middle" x="98" y="-194" font-family="Helvetica,sans-Serif" font-size="10.00">(first exception wins)</text>
<text text-anchor="middle" x="98" y="-183" font-family="Helvetica,sans-Serif" font-size="10.00">→ Scenario 1</text>
</g>
<g class="m-edge">
<title>explicit&#45;&gt;explicit_catch</title>
<path d="M113.86,-263.7C111.32,-253.1 108,-239.26 105.06,-226.97"/>
<polygon points="108.43,-226.03 102.7,-217.12 101.63,-227.66 108.43,-226.03"/>
<text text-anchor="middle" x="119" y="-238" font-family="Helvetica,sans-Serif" font-size="10.00">yes</text>
</g>
<g class="m-node m-flat">
<title>topology</title>
<polygon points="343.5,-214.5 206.5,-214.5 206.5,-178.5 343.5,-178.5 343.5,-214.5"/>
<text text-anchor="middle" x="275" y="-199.5" font-family="Helvetica,sans-Serif" font-size="10.00">Shared state found?</text>
<text text-anchor="middle" x="275" y="-188.5" font-family="Helvetica,sans-Serif" font-size="10.00">(e.g., promise, topology)</text>
</g>
<g class="m-edge">
<title>explicit&#45;&gt;topology</title>
<path d="M150.15,-263.9C174.39,-251.01 207.8,-233.24 233.97,-219.32"/>
<polygon points="235.71,-222.36 242.89,-214.58 232.42,-216.18 235.71,-222.36"/>
<text text-anchor="middle" x="208.5" y="-238" font-family="Helvetica,sans-Serif" font-size="10.00">no</text>
</g>
<g class="m-node m-flat">
<title>topology_catch</title>
<polygon points="310,-129 122,-129 122,-88 310,-88 310,-129"/>
<text text-anchor="middle" x="216" y="-117" font-family="Helvetica,sans-Serif" font-size="10.00">Store exception in the shared state</text>
<text text-anchor="middle" x="216" y="-106" font-family="Helvetica,sans-Serif" font-size="10.00">(first exception wins)</text>
<text text-anchor="middle" x="216" y="-95" font-family="Helvetica,sans-Serif" font-size="10.00">→ Scenario 2</text>
</g>
<g class="m-edge">
<title>topology&#45;&gt;topology_catch</title>
<path d="M263.06,-178.1C255.11,-166.5 244.47,-151 235.33,-137.67"/>
<polygon points="238.12,-135.55 229.57,-129.28 232.34,-139.51 238.12,-135.55"/>
<text text-anchor="middle" x="259" y="-150" font-family="Helvetica,sans-Serif" font-size="10.00">yes</text>
</g>
<g class="m-node m-flat">
<title>implicit</title>
<polygon points="496,-126.5 328,-126.5 328,-90.5 496,-90.5 496,-126.5"/>
<text text-anchor="middle" x="412" y="-111.5" font-family="Helvetica,sans-Serif" font-size="10.00">Implicit anchor found?</text>
<text text-anchor="middle" x="412" y="-100.5" font-family="Helvetica,sans-Serif" font-size="10.00">(e.g., task group, runtime task)</text>
</g>
<g class="m-edge">
<title>topology&#45;&gt;implicit</title>
<path d="M302.39,-178.3C323.58,-165 353.1,-146.48 376.16,-132"/>
<polygon points="378.04,-134.95 384.65,-126.67 374.32,-129.02 378.04,-134.95"/>
<text text-anchor="middle" x="358.5" y="-150" font-family="Helvetica,sans-Serif" font-size="10.00">no</text>
</g>
<g class="m-node m-flat">
<title>implicit_catch</title>
<polygon points="415.5,-41 234.5,-41 234.5,0 415.5,0 415.5,-41"/>
<text text-anchor="middle" x="325" y="-29" font-family="Helvetica,sans-Serif" font-size="10.00">Store exception in implicit anchor</text>
<text text-anchor="middle" x="325" y="-18" font-family="Helvetica,sans-Serif" font-size="10.00">(first exception wins)</text>
<text text-anchor="middle" x="325" y="-7" font-family="Helvetica,sans-Serif" font-size="10.00">→ Scenario 3</text>
</g>
<g class="m-edge">
<title>implicit&#45;&gt;implicit_catch</title>
<path d="M394.39,-90.1C382.33,-78.17 366.08,-62.11 352.35,-48.53"/>
<polygon points="354.59,-45.83 345.01,-41.28 349.67,-50.8 354.59,-45.83"/>
<text text-anchor="middle" x="383" y="-62" font-family="Helvetica,sans-Serif" font-size="10.00">yes</text>
</g>
<g class="m-node m-flat">
<title>silent</title>
<polygon points="562,-38.5 434,-38.5 434,-2.5 562,-2.5 562,-38.5"/>
<text text-anchor="middle" x="498" y="-23.5" font-family="Helvetica,sans-Serif" font-size="10.00">Store exception locally</text>
<text text-anchor="middle" x="498" y="-12.5" font-family="Helvetica,sans-Serif" font-size="10.00">(no exception report)</text>
</g>
<g class="m-edge">
<title>implicit&#45;&gt;silent</title>
<path d="M429.4,-90.1C442.08,-77.42 459.41,-60.09 473.48,-46.02"/>
<polygon points="476.32,-48.13 480.92,-38.58 471.37,-43.18 476.32,-48.13"/>
<text text-anchor="middle" x="466.5" y="-62" font-family="Helvetica,sans-Serif" font-size="10.00">no</text>
</g>
</g>
</svg>
</div></section></section><section id="CatchAnExceptionFromARunningTaskflow"><h2><a href="#CatchAnExceptionFromARunningTaskflow">Example: Catch an Exception from a Running Taskflow</a></h2><p>When a task throws an exception, the executor captures it and stores it in the shared state associated with the returned <a href="classtf_1_1Future.html" class="m-doc">tf::<wbr />Future</a> (a derived class of <a href="http://en.cppreference.com/w/cpp/thread/future.html" class="m-doc-external">std::<wbr />future</a>). You can later catch the exception by calling the <code>get</code> method:</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span>
<span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;exception&quot;</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">get</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">catch</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span></pre><aside class="m-note m-warning"><h4>Attention</h4><p>As <a href="classtf_1_1Future.html" class="m-doc">tf::<wbr />Future</a> is derived from <a href="https://en.cppreference.com/w/cpp/thread/future">std::<wbr />future</a>, it inherits all the exception handling behaviors defined by the C++ standard.</p></aside><p>When a task throws an exception, the executor automatically cancels the execution of its parent taskflow. All subsequent tasks that depend on the exception-throwing task will be skipped. For example, consider a taskflow with two tasks, <code>A</code> and <code>B</code>, where <code>B</code> runs after <code>A</code>. If <code>A</code> throws an exception, the executor cancels the remaining execution of the taskflow, preventing any dependent tasks (including <code>B</code>) from running.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;exception on A&quot;</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Task B</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">});</span>
<span class="n">A</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">B</span><span class="p">);</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">get</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">catch</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">()</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span></pre><pre class="m-code">~$ exception on A
<span class="c1"># execution of taskflow is cancelled after an execution is thrown</span></pre><p>When multiple tasks throw exceptions simultaneously, the executor will store only one of these exceptions in the shared state. Other exceptions will still be caught locally by their throwing tasks, but their handling will ignored. For example, in the following taskflow, both task <code>B</code> and task <code>C</code> may throw exceptions concurrently. Only one exception, either from task B or task C, will be propagated.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span>

<span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">,</span><span class="w"> </span><span class="n">D</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span>
<span class="w">  </span><span class="p">[]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;TaskA</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">},</span>
<span class="w">  </span><span class="p">[]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;TaskB</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;Exception on Task B&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">[]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;TaskC</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;Exception on Task C&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">[]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;TaskD will not be printed due to exception</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span><span class="p">}</span>
<span class="p">);</span>

<span class="n">A</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">);</span><span class="w">  </span><span class="c1">// A runs before B and C</span>
<span class="n">D</span><span class="p">.</span><span class="n">succeed</span><span class="p">(</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">);</span><span class="w">  </span><span class="c1">// D runs after  B and C</span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">get</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">catch</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">();</span><span class="w">  </span><span class="c1">// exception of either B or C is caught</span>
<span class="p">}</span></pre></section><section id="CatchAnExceptionFromASubflow"><h2><a href="#CatchAnExceptionFromASubflow">Example: Catch an Exception from a Subflow</a></h2><p>When you join a subflow using <a href="classtf_1_1Subflow.html#a59fcac1323e70d920088dd37bd0be245" class="m-doc">tf::<wbr />Subflow::<wbr />join</a>, you can catch an exception thrown by its children tasks. For example, the following code catches an exception from the child task <code>A</code> of the subflow <code>sf</code>:</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span>

<span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](</span><span class="n">tf</span><span class="o">::</span><span class="n">Subflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">sf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sf</span><span class="p">.</span><span class="n">emplace</span><span class="p">([]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Task A</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;exception on A&quot;</span><span class="p">);</span><span class="w"> </span>
<span class="w">  </span><span class="p">});</span>
<span class="w">  </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sf</span><span class="p">.</span><span class="n">emplace</span><span class="p">([]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Task B</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="p">});</span>
<span class="w">  </span><span class="n">A</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">B</span><span class="p">);</span>
<span class="w">  </span>
<span class="w">  </span><span class="c1">// catch the exception</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">sf</span><span class="p">.</span><span class="n">join</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">catch</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;exception thrown during subflow joining: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">});</span>

<span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">get</span><span class="p">();</span></pre><p>When an exception is thrown, it will cancel the execution of the parent subflow. All the subsequent tasks that depend on that exception task will not run. The above code example has the following output:</p><pre class="m-code">Task A
exception thrown during subflow joining: exception on A</pre><p>Uncaught exception will be propagated to the parent level until being explicitly caught. For example, the code below will propagate the exception to the parent of the subflow, which in this case in its taskflow.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span>

<span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](</span><span class="n">tf</span><span class="o">::</span><span class="n">Subflow</span><span class="o">&amp;</span><span class="w"> </span><span class="n">sf</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sf</span><span class="p">.</span><span class="n">emplace</span><span class="p">([]()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Task A</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;exception on A&quot;</span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>
<span class="w">  </span><span class="n">tf</span><span class="o">::</span><span class="n">Task</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sf</span><span class="p">.</span><span class="n">emplace</span><span class="p">([]()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;Task B</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span><span class="w"> </span>
<span class="w">  </span><span class="p">});</span><span class="w"> </span>
<span class="w">  </span><span class="n">A</span><span class="p">.</span><span class="n">precede</span><span class="p">(</span><span class="n">B</span><span class="p">);</span>

<span class="w">  </span><span class="c1">// uncaught exception will propagate to the parent</span>
<span class="w">  </span><span class="n">sf</span><span class="p">.</span><span class="n">join</span><span class="p">();</span>
<span class="p">});</span>

<span class="k">try</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">get</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;exception thrown from running the taskflow: &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">();</span>
<span class="p">}</span></pre><pre class="m-code">Task A
exception thrown from running the taskflow: exception on A</pre></section><section id="CatchAnExceptionFromAnAsyncTask"><h2><a href="#CatchAnExceptionFromAnAsyncTask">Example: Catch an Exception from an Async Task</a></h2><p>Similar to <a href="http://en.cppreference.com/w/cpp/thread/future.html" class="m-doc-external">std::<wbr />future</a>, <a href="classtf_1_1Executor.html#af960048056f7c6b5bc71f4f526f05df7" class="m-doc">tf::<wbr />Executor::<wbr />async</a> stores any exception in the shared state referenced by the returned <a href="http://en.cppreference.com/w/cpp/thread/future.html" class="m-doc-external">std::<wbr />future</a> handle.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span>
<span class="k">auto</span><span class="w"> </span><span class="n">fu</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">executor</span><span class="p">.</span><span class="n">async</span><span class="p">([](){</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;exception&quot;</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">fu</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">catch</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">();</span>
<span class="p">}</span></pre><p>On the other hand, since <a href="classtf_1_1Executor.html#a0461cb2c459c9f9473c72af06af9c701" class="m-doc">tf::<wbr />Executor::<wbr />silent_async</a> does not return any future handle, any exception thrown from a silent-async task will be silently caught by the executor and (1) propagated to the its parent context if one exists or (2) stored locally and ignored if that parent context does not exist.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span>

<span class="c1">// exception will be silently ignored</span>
<span class="n">executor</span><span class="p">.</span><span class="n">silent_async</span><span class="p">([](){</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;exception&quot;</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>

<span class="c1">// exception will be propagated to the parent Taskflow</span>
<span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Runtime</span><span class="o">&amp;</span><span class="w"> </span><span class="n">rt</span><span class="p">){</span>
<span class="w">  </span><span class="n">rt</span><span class="p">.</span><span class="n">silent_async</span><span class="p">([](){</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;exception&quot;</span><span class="p">);</span><span class="w"> </span><span class="p">});</span>
<span class="p">});</span>
<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">taskflow</span><span class="p">.</span><span class="n">get</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">catch</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">();</span>
<span class="p">}</span></pre></section><section id="CatchAnExceptionFromACorunLoop"><h2><a href="#CatchAnExceptionFromACorunLoop">Example: Catch an Exception from a Corun Loop</a></h2><p>When you corun a graph via <a href="classtf_1_1Executor.html#a8fcd9e0557922bb8194999f0cd433ea8" class="m-doc">tf::<wbr />Executor::<wbr />corun</a> or <a href="classtf_1_1Runtime.html#aba54a7cacffb54f5eb133730d256a7c4" class="m-doc">tf::<wbr />Runtime::<wbr />corun</a>, any exception will be thrown during the execution. For example, the code below will throw an exception during the execution of <code>taskflow1</code>:</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow1</span><span class="p">;</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow2</span><span class="p">;</span>

<span class="n">taskflow1</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span>
<span class="w">  </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;exception&quot;</span><span class="p">);</span>
<span class="p">});</span><span class="w"> </span>
<span class="n">taskflow2</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">executor</span><span class="p">.</span><span class="n">corun</span><span class="p">(</span><span class="n">taskflow1</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">});</span><span class="w"> </span>
<span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow2</span><span class="p">).</span><span class="n">get</span><span class="p">();</span></pre><p>We can observe the same behavior when using <a href="classtf_1_1Runtime.html#aba54a7cacffb54f5eb133730d256a7c4" class="m-doc">tf::<wbr />Runtime::<wbr />corun</a>:</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow1</span><span class="p">;</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow2</span><span class="p">;</span>

<span class="n">taskflow1</span><span class="p">.</span><span class="n">emplace</span><span class="p">([](){</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;exception&quot;</span><span class="p">);</span><span class="w"> </span><span class="p">});</span><span class="w"> </span>
<span class="n">taskflow2</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Runtime</span><span class="o">&amp;</span><span class="w"> </span><span class="n">rt</span><span class="p">){</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">rt</span><span class="p">.</span><span class="n">corun</span><span class="p">(</span><span class="n">taskflow1</span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">();</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">});</span><span class="w"> </span>
<span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow2</span><span class="p">).</span><span class="n">get</span><span class="p">();</span></pre><p>For the above example, if the exception is not caught with <a href="classtf_1_1Runtime.html#aba54a7cacffb54f5eb133730d256a7c4" class="m-doc">tf::<wbr />Runtime::<wbr />corun</a>, it will be propagated to its parent task, which is the <a href="classtf_1_1Runtime.html" class="m-doc">tf::<wbr />Runtime</a> object <code>rt</code> in this case. Then, the exception will be propagated to <code>taskflow2</code>.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="n">executor</span><span class="p">;</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow1</span><span class="p">;</span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow2</span><span class="p">;</span>

<span class="n">taskflow1</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](){</span><span class="w"> </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;exception&quot;</span><span class="p">);</span><span class="w"> </span><span class="p">});</span><span class="w"> </span>
<span class="n">taskflow2</span><span class="p">.</span><span class="n">emplace</span><span class="p">([</span><span class="o">&amp;</span><span class="p">](</span><span class="n">tf</span><span class="o">::</span><span class="n">Runtime</span><span class="o">&amp;</span><span class="w"> </span><span class="n">rt</span><span class="p">){</span><span class="w"> </span><span class="n">rt</span><span class="p">.</span><span class="n">corun</span><span class="p">(</span><span class="n">taskflow1</span><span class="p">);</span><span class="w"> </span><span class="p">});</span><span class="w"> </span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow2</span><span class="p">).</span><span class="n">get</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">catch</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">();</span>
<span class="p">}</span></pre><p>For the above example, if the exception is not caught with <a href="classtf_1_1Runtime.html#aba54a7cacffb54f5eb133730d256a7c4" class="m-doc">tf::<wbr />Runtime::<wbr />corun</a>, it will be propagated to its parent task, which is the <a href="classtf_1_1Runtime.html" class="m-doc">tf::<wbr />Runtime</a> object <code>rt</code> in this case. Then, the exception will be propagated to <code>taskflow2</code>.</p></section><section id="RetrieveTheExceptionPointerOfATask"><h2><a href="#RetrieveTheExceptionPointerOfATask">Retrieve the Exception Pointer of a Task</a></h2><p>When multiple tasks throw exceptions simultaneously, some exceptions may not be propagated. In such cases, Taskflow silently catches all unpropagated exceptions and stores them within their respective tasks. To inspect these exceptions, you can use <a href="classtf_1_1Task.html#a2f893050f81e40b12df4209bce4fa66b" class="m-doc">tf::<wbr />Task::<wbr />exception_ptr</a> to acquire a pointer to the exception stored in the task, if any. If the task executed without throwing an exception, this method returns <code>nullptr</code>. For example, in the code below, both tasks <code>B</code> and <code>C</code> throw exceptions. However, only one of them will be propagated to the try-catch block, while the other will be silently caught and stored within its respective task.</p><pre class="m-code"><span class="n">tf</span><span class="o">::</span><span class="n">Executor</span><span class="w"> </span><span class="nf">executor</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span><span class="w"> </span>
<span class="n">tf</span><span class="o">::</span><span class="n">Taskflow</span><span class="w"> </span><span class="n">taskflow</span><span class="p">;</span>
<span class="n">std</span><span class="o">::</span><span class="n">atomic</span><span class="o">&lt;</span><span class="kt">size_t</span><span class="o">&gt;</span><span class="w"> </span><span class="n">arrivals</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="k">auto</span><span class="w"> </span><span class="p">[</span><span class="n">B</span><span class="p">,</span><span class="w"> </span><span class="n">C</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">taskflow</span><span class="p">.</span><span class="n">emplace</span><span class="p">(</span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="c1">// wait for two threads to arrive so we avoid premature cancellation</span>
<span class="w">    </span><span class="o">++</span><span class="n">arrivals</span><span class="p">;</span><span class="w"> </span><span class="k">while</span><span class="p">(</span><span class="n">arrivals</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;oops&quot;</span><span class="p">);</span><span class="w"> </span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">[</span><span class="o">&amp;</span><span class="p">]()</span><span class="w"> </span><span class="p">{</span><span class="w"> </span>
<span class="w">    </span><span class="c1">// wait for two threads to arrive so we avoid premature cancellation</span>
<span class="w">    </span><span class="o">++</span><span class="n">arrivals</span><span class="p">;</span><span class="w"> </span><span class="k">while</span><span class="p">(</span><span class="n">arrivals</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="k">throw</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="p">(</span><span class="s">&quot;oops&quot;</span><span class="p">);</span><span class="w"> </span>
<span class="w">  </span><span class="p">}</span>
<span class="p">);</span>

<span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">executor</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">taskflow</span><span class="p">).</span><span class="n">get</span><span class="p">();</span>
<span class="p">}</span>
<span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">runtime_error</span><span class="o">&amp;</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">std</span><span class="o">::</span><span class="n">cerr</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">e</span><span class="p">.</span><span class="n">what</span><span class="p">();</span>
<span class="p">}</span>

<span class="c1">// exactly one holds an exception as another was propagated to the try-catch block</span>
<span class="n">assert</span><span class="p">((</span><span class="n">B</span><span class="p">.</span><span class="n">exception_ptr</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="p">(</span><span class="n">C</span><span class="p">.</span><span class="n">exception_ptr</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="k">nullptr</span><span class="p">));</span></pre></section><section id="TurnOffExceptionHandling"><h2><a href="#TurnOffExceptionHandling">Turn off Exception Handling</a></h2><p>In some applications, exception handling may not be desirable due to performance concerns, coding style preferences, or platform constraints. Taskflow allows you to disable exception handling entirely at compile time. To do this, define the macro <code>TF_DISABLE_EXCEPTION_HANDLING</code> when compiling your Taskflow program:</p><pre class="m-code"><span class="c1"># disable exception handling </span>
~$ g++ -DTF_DISABLE_EXCEPTION_HANDLING your_taskflow_prog.cpp</pre><p>Disabling exception handling removes all try-catch blocks from the Taskflow runtime, resulting in a leaner binary and potentially faster execution. However, Taskflow will no longer catch or report runtime exceptions.</p><aside class="m-note m-warning"><h4>Attention</h4><p>Disabling exception handling means that any exception thrown during execution will be unchecked, which may cause your program to behave unpredictably. Use this option only if your application does not rely on exception safety.</p></aside></section>
      </div>
    </div>
  </div>
</article></main>
<div class="m-doc-search" id="search">
  <a href="#!" onclick="return hideSearch()"></a>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-m-8 m-push-m-2">
        <div class="m-doc-search-header m-text m-small">
          <div><span class="m-label m-default">Tab</span> / <span class="m-label m-default">T</span> to search, <span class="m-label m-default">Esc</span> to close</div>
          <div id="search-symbolcount">&hellip;</div>
        </div>
        <div class="m-doc-search-content">
          <form>
            <input type="search" name="q" id="search-input" placeholder="Loading &hellip;" disabled="disabled" autofocus="autofocus" autocomplete="off" spellcheck="false" />
          </form>
          <noscript class="m-text m-danger m-text-center">Unlike everything else in the docs, the search functionality <em>requires</em> JavaScript.</noscript>
          <div id="search-help" class="m-text m-dim m-text-center">
            <p class="m-noindent">Search for symbols, directories, files, pages or
            modules. You can omit any prefix from the symbol or file path; adding a
            <code>:</code> or <code>/</code> suffix lists all members of given symbol or
            directory.</p>
            <p class="m-noindent">Use <span class="m-label m-dim">&darr;</span>
            / <span class="m-label m-dim">&uarr;</span> to navigate through the list,
            <span class="m-label m-dim">Enter</span> to go.
            <span class="m-label m-dim">Tab</span> autocompletes common prefix, you can
            copy a link to the result using <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">L</span> while <span class="m-label m-dim">⌘</span>
            <span class="m-label m-dim">M</span> produces a Markdown link.</p>
          </div>
          <div id="search-notfound" class="m-text m-warning m-text-center">Sorry, nothing was found.</div>
          <ul id="search-results"></ul>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="search-v2.js"></script>
<script src="searchdata-v2.js" async="async"></script>
<footer><nav>
  <div class="m-container">
    <div class="m-row">
      <div class="m-col-l-10 m-push-l-1">
        <p>Taskflow handbook is part of the <a href="https://taskflow.github.io">Taskflow project</a>, copyright © <a href="https://tsung-wei-huang.github.io/">Dr. Tsung-Wei Huang</a>, 2018&ndash;2026.<br />Generated by <a href="https://doxygen.org/">Doxygen</a> 1.9.1 and <a href="https://mcss.mosra.cz/">m.css</a>.</p>
      </div>
    </div>
  </div>
</nav></footer>
</body>
</html>
